This is the legacy version of the code, done for fun at one point, and mostly obsolete.
